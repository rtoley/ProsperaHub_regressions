//============================================================================
// Hyperplane VPU - LUT ROM for LLM Inference Functions
// AUTO-GENERATED - DO NOT EDIT
// Run: python3 scripts/gen_lut_tables.py
//
// Tables:
//   exp:   exp(x/16) * 256, x in [-128, 127]
//   recip: 32768/x, x in [1, 255]
//   rsqrt: 16384/sqrt(x), x in [1, 255]
//   gelu:  gelu(x/32) * 128 + 64, x in [-128, 127]
//============================================================================

`timescale 1ns/1ps

module hp_vpu_lut_rom (
  input  logic        clk,        // Added for BRAM version compatibility
  input  logic [7:0]  index_i,
  input  logic [1:0]  func_sel_i,  // 0=exp, 1=recip, 2=rsqrt, 3=gelu
  output logic [15:0] result_o
);

  // Function select encoding
  localparam logic [1:0] FUNC_EXP   = 2'd0;
  localparam logic [1:0] FUNC_RECIP = 2'd1;
  localparam logic [1:0] FUNC_RSQRT = 2'd2;
  localparam logic [1:0] FUNC_GELU  = 2'd3;

  // Scaling constants (for software reference)
  localparam int EXP_INPUT_SCALE  = 16;
  localparam int EXP_OUTPUT_SCALE = 256;
  localparam int RECIP_SCALE      = 32768;
  localparam int RSQRT_SCALE      = 16384;
  localparam int GELU_INPUT_SCALE = 32;
  localparam int GELU_OUTPUT_SCALE = 128;

  // EXP table (256 x 16-bit)
  logic [15:0] exp_table [0:255];
  initial begin
    exp_table[0] = 16'h0100;
    exp_table[1] = 16'h0111;
    exp_table[2] = 16'h0122;
    exp_table[3] = 16'h0135;
    exp_table[4] = 16'h0149;
    exp_table[5] = 16'h015e;
    exp_table[6] = 16'h0174;
    exp_table[7] = 16'h018d;
    exp_table[8] = 16'h01a6;
    exp_table[9] = 16'h01c1;
    exp_table[10] = 16'h01de;
    exp_table[11] = 16'h01fd;
    exp_table[12] = 16'h021e;
    exp_table[13] = 16'h0241;
    exp_table[14] = 16'h0266;
    exp_table[15] = 16'h028e;
    exp_table[16] = 16'h02b8;
    exp_table[17] = 16'h02e5;
    exp_table[18] = 16'h0315;
    exp_table[19] = 16'h0347;
    exp_table[20] = 16'h037e;
    exp_table[21] = 16'h03b7;
    exp_table[22] = 16'h03f4;
    exp_table[23] = 16'h0436;
    exp_table[24] = 16'h047b;
    exp_table[25] = 16'h04c5;
    exp_table[26] = 16'h0514;
    exp_table[27] = 16'h0568;
    exp_table[28] = 16'h05c1;
    exp_table[29] = 16'h0620;
    exp_table[30] = 16'h0685;
    exp_table[31] = 16'h06f1;
    exp_table[32] = 16'h0764;
    exp_table[33] = 16'h07de;
    exp_table[34] = 16'h085f;
    exp_table[35] = 16'h08ea;
    exp_table[36] = 16'h097d;
    exp_table[37] = 16'h0a1a;
    exp_table[38] = 16'h0ac0;
    exp_table[39] = 16'h0b72;
    exp_table[40] = 16'h0c2f;
    exp_table[41] = 16'h0cf8;
    exp_table[42] = 16'h0dce;
    exp_table[43] = 16'h0eb2;
    exp_table[44] = 16'h0fa5;
    exp_table[45] = 16'h10a7;
    exp_table[46] = 16'h11ba;
    exp_table[47] = 16'h12de;
    exp_table[48] = 16'h1416;
    exp_table[49] = 16'h1562;
    exp_table[50] = 16'h16c3;
    exp_table[51] = 16'h183a;
    exp_table[52] = 16'h19ca;
    exp_table[53] = 16'h1b74;
    exp_table[54] = 16'h1d39;
    exp_table[55] = 16'h1f1c;
    exp_table[56] = 16'h211e;
    exp_table[57] = 16'h2340;
    exp_table[58] = 16'h2586;
    exp_table[59] = 16'h27f2;
    exp_table[60] = 16'h2a85;
    exp_table[61] = 16'h2d43;
    exp_table[62] = 16'h302f;
    exp_table[63] = 16'h334a;
    exp_table[64] = 16'h3699;
    exp_table[65] = 16'h3a1f;
    exp_table[66] = 16'h3dde;
    exp_table[67] = 16'h41dc;
    exp_table[68] = 16'h461b;
    exp_table[69] = 16'h4aa0;
    exp_table[70] = 16'h4f71;
    exp_table[71] = 16'h5490;
    exp_table[72] = 16'h5a04;
    exp_table[73] = 16'h5fd3;
    exp_table[74] = 16'h6601;
    exp_table[75] = 16'h6c95;
    exp_table[76] = 16'h7396;
    exp_table[77] = 16'h7b0a;
    exp_table[78] = 16'h82f9;
    exp_table[79] = 16'h8b6c;
    exp_table[80] = 16'h946a;
    exp_table[81] = 16'h9dfc;
    exp_table[82] = 16'ha82d;
    exp_table[83] = 16'hb305;
    exp_table[84] = 16'hbe91;
    exp_table[85] = 16'hcadb;
    exp_table[86] = 16'hd7f1;
    exp_table[87] = 16'he5de;
    exp_table[88] = 16'hf4b1;
    exp_table[89] = 16'hffff;
    exp_table[90] = 16'hffff;
    exp_table[91] = 16'hffff;
    exp_table[92] = 16'hffff;
    exp_table[93] = 16'hffff;
    exp_table[94] = 16'hffff;
    exp_table[95] = 16'hffff;
    exp_table[96] = 16'hffff;
    exp_table[97] = 16'hffff;
    exp_table[98] = 16'hffff;
    exp_table[99] = 16'hffff;
    exp_table[100] = 16'hffff;
    exp_table[101] = 16'hffff;
    exp_table[102] = 16'hffff;
    exp_table[103] = 16'hffff;
    exp_table[104] = 16'hffff;
    exp_table[105] = 16'hffff;
    exp_table[106] = 16'hffff;
    exp_table[107] = 16'hffff;
    exp_table[108] = 16'hffff;
    exp_table[109] = 16'hffff;
    exp_table[110] = 16'hffff;
    exp_table[111] = 16'hffff;
    exp_table[112] = 16'hffff;
    exp_table[113] = 16'hffff;
    exp_table[114] = 16'hffff;
    exp_table[115] = 16'hffff;
    exp_table[116] = 16'hffff;
    exp_table[117] = 16'hffff;
    exp_table[118] = 16'hffff;
    exp_table[119] = 16'hffff;
    exp_table[120] = 16'hffff;
    exp_table[121] = 16'hffff;
    exp_table[122] = 16'hffff;
    exp_table[123] = 16'hffff;
    exp_table[124] = 16'hffff;
    exp_table[125] = 16'hffff;
    exp_table[126] = 16'hffff;
    exp_table[127] = 16'hffff;
    exp_table[128] = 16'h0000;
    exp_table[129] = 16'h0000;
    exp_table[130] = 16'h0000;
    exp_table[131] = 16'h0000;
    exp_table[132] = 16'h0000;
    exp_table[133] = 16'h0000;
    exp_table[134] = 16'h0000;
    exp_table[135] = 16'h0000;
    exp_table[136] = 16'h0000;
    exp_table[137] = 16'h0000;
    exp_table[138] = 16'h0000;
    exp_table[139] = 16'h0000;
    exp_table[140] = 16'h0000;
    exp_table[141] = 16'h0000;
    exp_table[142] = 16'h0000;
    exp_table[143] = 16'h0000;
    exp_table[144] = 16'h0000;
    exp_table[145] = 16'h0000;
    exp_table[146] = 16'h0000;
    exp_table[147] = 16'h0000;
    exp_table[148] = 16'h0000;
    exp_table[149] = 16'h0000;
    exp_table[150] = 16'h0000;
    exp_table[151] = 16'h0000;
    exp_table[152] = 16'h0000;
    exp_table[153] = 16'h0000;
    exp_table[154] = 16'h0000;
    exp_table[155] = 16'h0000;
    exp_table[156] = 16'h0000;
    exp_table[157] = 16'h0001;
    exp_table[158] = 16'h0001;
    exp_table[159] = 16'h0001;
    exp_table[160] = 16'h0001;
    exp_table[161] = 16'h0001;
    exp_table[162] = 16'h0001;
    exp_table[163] = 16'h0001;
    exp_table[164] = 16'h0001;
    exp_table[165] = 16'h0001;
    exp_table[166] = 16'h0001;
    exp_table[167] = 16'h0001;
    exp_table[168] = 16'h0001;
    exp_table[169] = 16'h0001;
    exp_table[170] = 16'h0001;
    exp_table[171] = 16'h0001;
    exp_table[172] = 16'h0001;
    exp_table[173] = 16'h0001;
    exp_table[174] = 16'h0002;
    exp_table[175] = 16'h0002;
    exp_table[176] = 16'h0002;
    exp_table[177] = 16'h0002;
    exp_table[178] = 16'h0002;
    exp_table[179] = 16'h0002;
    exp_table[180] = 16'h0002;
    exp_table[181] = 16'h0002;
    exp_table[182] = 16'h0003;
    exp_table[183] = 16'h0003;
    exp_table[184] = 16'h0003;
    exp_table[185] = 16'h0003;
    exp_table[186] = 16'h0003;
    exp_table[187] = 16'h0003;
    exp_table[188] = 16'h0004;
    exp_table[189] = 16'h0004;
    exp_table[190] = 16'h0004;
    exp_table[191] = 16'h0004;
    exp_table[192] = 16'h0005;
    exp_table[193] = 16'h0005;
    exp_table[194] = 16'h0005;
    exp_table[195] = 16'h0006;
    exp_table[196] = 16'h0006;
    exp_table[197] = 16'h0006;
    exp_table[198] = 16'h0007;
    exp_table[199] = 16'h0007;
    exp_table[200] = 16'h0008;
    exp_table[201] = 16'h0008;
    exp_table[202] = 16'h0009;
    exp_table[203] = 16'h0009;
    exp_table[204] = 16'h000a;
    exp_table[205] = 16'h000b;
    exp_table[206] = 16'h000b;
    exp_table[207] = 16'h000c;
    exp_table[208] = 16'h000d;
    exp_table[209] = 16'h000e;
    exp_table[210] = 16'h000e;
    exp_table[211] = 16'h000f;
    exp_table[212] = 16'h0010;
    exp_table[213] = 16'h0011;
    exp_table[214] = 16'h0013;
    exp_table[215] = 16'h0014;
    exp_table[216] = 16'h0015;
    exp_table[217] = 16'h0016;
    exp_table[218] = 16'h0018;
    exp_table[219] = 16'h0019;
    exp_table[220] = 16'h001b;
    exp_table[221] = 16'h001d;
    exp_table[222] = 16'h001f;
    exp_table[223] = 16'h0021;
    exp_table[224] = 16'h0023;
    exp_table[225] = 16'h0025;
    exp_table[226] = 16'h0027;
    exp_table[227] = 16'h002a;
    exp_table[228] = 16'h002c;
    exp_table[229] = 16'h002f;
    exp_table[230] = 16'h0032;
    exp_table[231] = 16'h0036;
    exp_table[232] = 16'h0039;
    exp_table[233] = 16'h003d;
    exp_table[234] = 16'h0041;
    exp_table[235] = 16'h0045;
    exp_table[236] = 16'h0049;
    exp_table[237] = 16'h004e;
    exp_table[238] = 16'h0053;
    exp_table[239] = 16'h0058;
    exp_table[240] = 16'h005e;
    exp_table[241] = 16'h0064;
    exp_table[242] = 16'h006b;
    exp_table[243] = 16'h0072;
    exp_table[244] = 16'h0079;
    exp_table[245] = 16'h0081;
    exp_table[246] = 16'h0089;
    exp_table[247] = 16'h0092;
    exp_table[248] = 16'h009b;
    exp_table[249] = 16'h00a5;
    exp_table[250] = 16'h00b0;
    exp_table[251] = 16'h00bb;
    exp_table[252] = 16'h00c7;
    exp_table[253] = 16'h00d4;
    exp_table[254] = 16'h00e2;
    exp_table[255] = 16'h00f0;
  end

  // RECIP table (256 x 16-bit)
  logic [15:0] recip_table [0:255];
  initial begin
    recip_table[0] = 16'hffff;
    recip_table[1] = 16'h8000;
    recip_table[2] = 16'h4000;
    recip_table[3] = 16'h2aab;
    recip_table[4] = 16'h2000;
    recip_table[5] = 16'h199a;
    recip_table[6] = 16'h1555;
    recip_table[7] = 16'h1249;
    recip_table[8] = 16'h1000;
    recip_table[9] = 16'h0e39;
    recip_table[10] = 16'h0ccd;
    recip_table[11] = 16'h0ba3;
    recip_table[12] = 16'h0aab;
    recip_table[13] = 16'h09d9;
    recip_table[14] = 16'h0925;
    recip_table[15] = 16'h0889;
    recip_table[16] = 16'h0800;
    recip_table[17] = 16'h0788;
    recip_table[18] = 16'h071c;
    recip_table[19] = 16'h06bd;
    recip_table[20] = 16'h0666;
    recip_table[21] = 16'h0618;
    recip_table[22] = 16'h05d1;
    recip_table[23] = 16'h0591;
    recip_table[24] = 16'h0555;
    recip_table[25] = 16'h051f;
    recip_table[26] = 16'h04ec;
    recip_table[27] = 16'h04be;
    recip_table[28] = 16'h0492;
    recip_table[29] = 16'h046a;
    recip_table[30] = 16'h0444;
    recip_table[31] = 16'h0421;
    recip_table[32] = 16'h0400;
    recip_table[33] = 16'h03e1;
    recip_table[34] = 16'h03c4;
    recip_table[35] = 16'h03a8;
    recip_table[36] = 16'h038e;
    recip_table[37] = 16'h0376;
    recip_table[38] = 16'h035e;
    recip_table[39] = 16'h0348;
    recip_table[40] = 16'h0333;
    recip_table[41] = 16'h031f;
    recip_table[42] = 16'h030c;
    recip_table[43] = 16'h02fa;
    recip_table[44] = 16'h02e9;
    recip_table[45] = 16'h02d8;
    recip_table[46] = 16'h02c8;
    recip_table[47] = 16'h02b9;
    recip_table[48] = 16'h02ab;
    recip_table[49] = 16'h029d;
    recip_table[50] = 16'h028f;
    recip_table[51] = 16'h0283;
    recip_table[52] = 16'h0276;
    recip_table[53] = 16'h026a;
    recip_table[54] = 16'h025f;
    recip_table[55] = 16'h0254;
    recip_table[56] = 16'h0249;
    recip_table[57] = 16'h023f;
    recip_table[58] = 16'h0235;
    recip_table[59] = 16'h022b;
    recip_table[60] = 16'h0222;
    recip_table[61] = 16'h0219;
    recip_table[62] = 16'h0211;
    recip_table[63] = 16'h0208;
    recip_table[64] = 16'h0200;
    recip_table[65] = 16'h01f8;
    recip_table[66] = 16'h01f0;
    recip_table[67] = 16'h01e9;
    recip_table[68] = 16'h01e2;
    recip_table[69] = 16'h01db;
    recip_table[70] = 16'h01d4;
    recip_table[71] = 16'h01ce;
    recip_table[72] = 16'h01c7;
    recip_table[73] = 16'h01c1;
    recip_table[74] = 16'h01bb;
    recip_table[75] = 16'h01b5;
    recip_table[76] = 16'h01af;
    recip_table[77] = 16'h01aa;
    recip_table[78] = 16'h01a4;
    recip_table[79] = 16'h019f;
    recip_table[80] = 16'h019a;
    recip_table[81] = 16'h0195;
    recip_table[82] = 16'h0190;
    recip_table[83] = 16'h018b;
    recip_table[84] = 16'h0186;
    recip_table[85] = 16'h0182;
    recip_table[86] = 16'h017d;
    recip_table[87] = 16'h0179;
    recip_table[88] = 16'h0174;
    recip_table[89] = 16'h0170;
    recip_table[90] = 16'h016c;
    recip_table[91] = 16'h0168;
    recip_table[92] = 16'h0164;
    recip_table[93] = 16'h0160;
    recip_table[94] = 16'h015d;
    recip_table[95] = 16'h0159;
    recip_table[96] = 16'h0155;
    recip_table[97] = 16'h0152;
    recip_table[98] = 16'h014e;
    recip_table[99] = 16'h014b;
    recip_table[100] = 16'h0148;
    recip_table[101] = 16'h0144;
    recip_table[102] = 16'h0141;
    recip_table[103] = 16'h013e;
    recip_table[104] = 16'h013b;
    recip_table[105] = 16'h0138;
    recip_table[106] = 16'h0135;
    recip_table[107] = 16'h0132;
    recip_table[108] = 16'h012f;
    recip_table[109] = 16'h012d;
    recip_table[110] = 16'h012a;
    recip_table[111] = 16'h0127;
    recip_table[112] = 16'h0125;
    recip_table[113] = 16'h0122;
    recip_table[114] = 16'h011f;
    recip_table[115] = 16'h011d;
    recip_table[116] = 16'h011a;
    recip_table[117] = 16'h0118;
    recip_table[118] = 16'h0116;
    recip_table[119] = 16'h0113;
    recip_table[120] = 16'h0111;
    recip_table[121] = 16'h010f;
    recip_table[122] = 16'h010d;
    recip_table[123] = 16'h010a;
    recip_table[124] = 16'h0108;
    recip_table[125] = 16'h0106;
    recip_table[126] = 16'h0104;
    recip_table[127] = 16'h0102;
    recip_table[128] = 16'h0100;
    recip_table[129] = 16'h00fe;
    recip_table[130] = 16'h00fc;
    recip_table[131] = 16'h00fa;
    recip_table[132] = 16'h00f8;
    recip_table[133] = 16'h00f6;
    recip_table[134] = 16'h00f5;
    recip_table[135] = 16'h00f3;
    recip_table[136] = 16'h00f1;
    recip_table[137] = 16'h00ef;
    recip_table[138] = 16'h00ed;
    recip_table[139] = 16'h00ec;
    recip_table[140] = 16'h00ea;
    recip_table[141] = 16'h00e8;
    recip_table[142] = 16'h00e7;
    recip_table[143] = 16'h00e5;
    recip_table[144] = 16'h00e4;
    recip_table[145] = 16'h00e2;
    recip_table[146] = 16'h00e0;
    recip_table[147] = 16'h00df;
    recip_table[148] = 16'h00dd;
    recip_table[149] = 16'h00dc;
    recip_table[150] = 16'h00da;
    recip_table[151] = 16'h00d9;
    recip_table[152] = 16'h00d8;
    recip_table[153] = 16'h00d6;
    recip_table[154] = 16'h00d5;
    recip_table[155] = 16'h00d3;
    recip_table[156] = 16'h00d2;
    recip_table[157] = 16'h00d1;
    recip_table[158] = 16'h00cf;
    recip_table[159] = 16'h00ce;
    recip_table[160] = 16'h00cd;
    recip_table[161] = 16'h00cc;
    recip_table[162] = 16'h00ca;
    recip_table[163] = 16'h00c9;
    recip_table[164] = 16'h00c8;
    recip_table[165] = 16'h00c7;
    recip_table[166] = 16'h00c5;
    recip_table[167] = 16'h00c4;
    recip_table[168] = 16'h00c3;
    recip_table[169] = 16'h00c2;
    recip_table[170] = 16'h00c1;
    recip_table[171] = 16'h00c0;
    recip_table[172] = 16'h00bf;
    recip_table[173] = 16'h00bd;
    recip_table[174] = 16'h00bc;
    recip_table[175] = 16'h00bb;
    recip_table[176] = 16'h00ba;
    recip_table[177] = 16'h00b9;
    recip_table[178] = 16'h00b8;
    recip_table[179] = 16'h00b7;
    recip_table[180] = 16'h00b6;
    recip_table[181] = 16'h00b5;
    recip_table[182] = 16'h00b4;
    recip_table[183] = 16'h00b3;
    recip_table[184] = 16'h00b2;
    recip_table[185] = 16'h00b1;
    recip_table[186] = 16'h00b0;
    recip_table[187] = 16'h00af;
    recip_table[188] = 16'h00ae;
    recip_table[189] = 16'h00ad;
    recip_table[190] = 16'h00ac;
    recip_table[191] = 16'h00ac;
    recip_table[192] = 16'h00ab;
    recip_table[193] = 16'h00aa;
    recip_table[194] = 16'h00a9;
    recip_table[195] = 16'h00a8;
    recip_table[196] = 16'h00a7;
    recip_table[197] = 16'h00a6;
    recip_table[198] = 16'h00a5;
    recip_table[199] = 16'h00a5;
    recip_table[200] = 16'h00a4;
    recip_table[201] = 16'h00a3;
    recip_table[202] = 16'h00a2;
    recip_table[203] = 16'h00a1;
    recip_table[204] = 16'h00a1;
    recip_table[205] = 16'h00a0;
    recip_table[206] = 16'h009f;
    recip_table[207] = 16'h009e;
    recip_table[208] = 16'h009e;
    recip_table[209] = 16'h009d;
    recip_table[210] = 16'h009c;
    recip_table[211] = 16'h009b;
    recip_table[212] = 16'h009b;
    recip_table[213] = 16'h009a;
    recip_table[214] = 16'h0099;
    recip_table[215] = 16'h0098;
    recip_table[216] = 16'h0098;
    recip_table[217] = 16'h0097;
    recip_table[218] = 16'h0096;
    recip_table[219] = 16'h0096;
    recip_table[220] = 16'h0095;
    recip_table[221] = 16'h0094;
    recip_table[222] = 16'h0094;
    recip_table[223] = 16'h0093;
    recip_table[224] = 16'h0092;
    recip_table[225] = 16'h0092;
    recip_table[226] = 16'h0091;
    recip_table[227] = 16'h0090;
    recip_table[228] = 16'h0090;
    recip_table[229] = 16'h008f;
    recip_table[230] = 16'h008e;
    recip_table[231] = 16'h008e;
    recip_table[232] = 16'h008d;
    recip_table[233] = 16'h008d;
    recip_table[234] = 16'h008c;
    recip_table[235] = 16'h008b;
    recip_table[236] = 16'h008b;
    recip_table[237] = 16'h008a;
    recip_table[238] = 16'h008a;
    recip_table[239] = 16'h0089;
    recip_table[240] = 16'h0089;
    recip_table[241] = 16'h0088;
    recip_table[242] = 16'h0087;
    recip_table[243] = 16'h0087;
    recip_table[244] = 16'h0086;
    recip_table[245] = 16'h0086;
    recip_table[246] = 16'h0085;
    recip_table[247] = 16'h0085;
    recip_table[248] = 16'h0084;
    recip_table[249] = 16'h0084;
    recip_table[250] = 16'h0083;
    recip_table[251] = 16'h0083;
    recip_table[252] = 16'h0082;
    recip_table[253] = 16'h0082;
    recip_table[254] = 16'h0081;
    recip_table[255] = 16'h0081;
  end

  // RSQRT table (256 x 16-bit)
  logic [15:0] rsqrt_table [0:255];
  initial begin
    rsqrt_table[0] = 16'hffff;
    rsqrt_table[1] = 16'h4000;
    rsqrt_table[2] = 16'h2d41;
    rsqrt_table[3] = 16'h24f3;
    rsqrt_table[4] = 16'h2000;
    rsqrt_table[5] = 16'h1c9f;
    rsqrt_table[6] = 16'h1a21;
    rsqrt_table[7] = 16'h1831;
    rsqrt_table[8] = 16'h16a1;
    rsqrt_table[9] = 16'h1555;
    rsqrt_table[10] = 16'h143d;
    rsqrt_table[11] = 16'h134c;
    rsqrt_table[12] = 16'h127a;
    rsqrt_table[13] = 16'h11c0;
    rsqrt_table[14] = 16'h111b;
    rsqrt_table[15] = 16'h1086;
    rsqrt_table[16] = 16'h1000;
    rsqrt_table[17] = 16'h0f86;
    rsqrt_table[18] = 16'h0f16;
    rsqrt_table[19] = 16'h0eaf;
    rsqrt_table[20] = 16'h0e50;
    rsqrt_table[21] = 16'h0df7;
    rsqrt_table[22] = 16'h0da5;
    rsqrt_table[23] = 16'h0d58;
    rsqrt_table[24] = 16'h0d10;
    rsqrt_table[25] = 16'h0ccd;
    rsqrt_table[26] = 16'h0c8d;
    rsqrt_table[27] = 16'h0c51;
    rsqrt_table[28] = 16'h0c18;
    rsqrt_table[29] = 16'h0be2;
    rsqrt_table[30] = 16'h0baf;
    rsqrt_table[31] = 16'h0b7f;
    rsqrt_table[32] = 16'h0b50;
    rsqrt_table[33] = 16'h0b24;
    rsqrt_table[34] = 16'h0afa;
    rsqrt_table[35] = 16'h0ad1;
    rsqrt_table[36] = 16'h0aab;
    rsqrt_table[37] = 16'h0a86;
    rsqrt_table[38] = 16'h0a62;
    rsqrt_table[39] = 16'h0a40;
    rsqrt_table[40] = 16'h0a1f;
    rsqrt_table[41] = 16'h09ff;
    rsqrt_table[42] = 16'h09e0;
    rsqrt_table[43] = 16'h09c3;
    rsqrt_table[44] = 16'h09a6;
    rsqrt_table[45] = 16'h098a;
    rsqrt_table[46] = 16'h0970;
    rsqrt_table[47] = 16'h0956;
    rsqrt_table[48] = 16'h093d;
    rsqrt_table[49] = 16'h0925;
    rsqrt_table[50] = 16'h090d;
    rsqrt_table[51] = 16'h08f6;
    rsqrt_table[52] = 16'h08e0;
    rsqrt_table[53] = 16'h08cb;
    rsqrt_table[54] = 16'h08b6;
    rsqrt_table[55] = 16'h08a1;
    rsqrt_table[56] = 16'h088d;
    rsqrt_table[57] = 16'h087a;
    rsqrt_table[58] = 16'h0867;
    rsqrt_table[59] = 16'h0855;
    rsqrt_table[60] = 16'h0843;
    rsqrt_table[61] = 16'h0832;
    rsqrt_table[62] = 16'h0821;
    rsqrt_table[63] = 16'h0810;
    rsqrt_table[64] = 16'h0800;
    rsqrt_table[65] = 16'h07f0;
    rsqrt_table[66] = 16'h07e1;
    rsqrt_table[67] = 16'h07d2;
    rsqrt_table[68] = 16'h07c3;
    rsqrt_table[69] = 16'h07b4;
    rsqrt_table[70] = 16'h07a6;
    rsqrt_table[71] = 16'h0798;
    rsqrt_table[72] = 16'h078b;
    rsqrt_table[73] = 16'h077e;
    rsqrt_table[74] = 16'h0771;
    rsqrt_table[75] = 16'h0764;
    rsqrt_table[76] = 16'h0757;
    rsqrt_table[77] = 16'h074b;
    rsqrt_table[78] = 16'h073f;
    rsqrt_table[79] = 16'h0733;
    rsqrt_table[80] = 16'h0728;
    rsqrt_table[81] = 16'h071c;
    rsqrt_table[82] = 16'h0711;
    rsqrt_table[83] = 16'h0706;
    rsqrt_table[84] = 16'h06fc;
    rsqrt_table[85] = 16'h06f1;
    rsqrt_table[86] = 16'h06e7;
    rsqrt_table[87] = 16'h06dd;
    rsqrt_table[88] = 16'h06d3;
    rsqrt_table[89] = 16'h06c9;
    rsqrt_table[90] = 16'h06bf;
    rsqrt_table[91] = 16'h06b6;
    rsqrt_table[92] = 16'h06ac;
    rsqrt_table[93] = 16'h06a3;
    rsqrt_table[94] = 16'h069a;
    rsqrt_table[95] = 16'h0691;
    rsqrt_table[96] = 16'h0688;
    rsqrt_table[97] = 16'h0680;
    rsqrt_table[98] = 16'h0677;
    rsqrt_table[99] = 16'h066f;
    rsqrt_table[100] = 16'h0666;
    rsqrt_table[101] = 16'h065e;
    rsqrt_table[102] = 16'h0656;
    rsqrt_table[103] = 16'h064e;
    rsqrt_table[104] = 16'h0647;
    rsqrt_table[105] = 16'h063f;
    rsqrt_table[106] = 16'h0637;
    rsqrt_table[107] = 16'h0630;
    rsqrt_table[108] = 16'h0629;
    rsqrt_table[109] = 16'h0621;
    rsqrt_table[110] = 16'h061a;
    rsqrt_table[111] = 16'h0613;
    rsqrt_table[112] = 16'h060c;
    rsqrt_table[113] = 16'h0605;
    rsqrt_table[114] = 16'h05ff;
    rsqrt_table[115] = 16'h05f8;
    rsqrt_table[116] = 16'h05f1;
    rsqrt_table[117] = 16'h05eb;
    rsqrt_table[118] = 16'h05e4;
    rsqrt_table[119] = 16'h05de;
    rsqrt_table[120] = 16'h05d8;
    rsqrt_table[121] = 16'h05d1;
    rsqrt_table[122] = 16'h05cb;
    rsqrt_table[123] = 16'h05c5;
    rsqrt_table[124] = 16'h05bf;
    rsqrt_table[125] = 16'h05b9;
    rsqrt_table[126] = 16'h05b4;
    rsqrt_table[127] = 16'h05ae;
    rsqrt_table[128] = 16'h05a8;
    rsqrt_table[129] = 16'h05a3;
    rsqrt_table[130] = 16'h059d;
    rsqrt_table[131] = 16'h0597;
    rsqrt_table[132] = 16'h0592;
    rsqrt_table[133] = 16'h058d;
    rsqrt_table[134] = 16'h0587;
    rsqrt_table[135] = 16'h0582;
    rsqrt_table[136] = 16'h057d;
    rsqrt_table[137] = 16'h0578;
    rsqrt_table[138] = 16'h0573;
    rsqrt_table[139] = 16'h056e;
    rsqrt_table[140] = 16'h0569;
    rsqrt_table[141] = 16'h0564;
    rsqrt_table[142] = 16'h055f;
    rsqrt_table[143] = 16'h055a;
    rsqrt_table[144] = 16'h0555;
    rsqrt_table[145] = 16'h0551;
    rsqrt_table[146] = 16'h054c;
    rsqrt_table[147] = 16'h0547;
    rsqrt_table[148] = 16'h0543;
    rsqrt_table[149] = 16'h053e;
    rsqrt_table[150] = 16'h053a;
    rsqrt_table[151] = 16'h0535;
    rsqrt_table[152] = 16'h0531;
    rsqrt_table[153] = 16'h052d;
    rsqrt_table[154] = 16'h0528;
    rsqrt_table[155] = 16'h0524;
    rsqrt_table[156] = 16'h0520;
    rsqrt_table[157] = 16'h051c;
    rsqrt_table[158] = 16'h0517;
    rsqrt_table[159] = 16'h0513;
    rsqrt_table[160] = 16'h050f;
    rsqrt_table[161] = 16'h050b;
    rsqrt_table[162] = 16'h0507;
    rsqrt_table[163] = 16'h0503;
    rsqrt_table[164] = 16'h04ff;
    rsqrt_table[165] = 16'h04fb;
    rsqrt_table[166] = 16'h04f8;
    rsqrt_table[167] = 16'h04f4;
    rsqrt_table[168] = 16'h04f0;
    rsqrt_table[169] = 16'h04ec;
    rsqrt_table[170] = 16'h04e9;
    rsqrt_table[171] = 16'h04e5;
    rsqrt_table[172] = 16'h04e1;
    rsqrt_table[173] = 16'h04de;
    rsqrt_table[174] = 16'h04da;
    rsqrt_table[175] = 16'h04d7;
    rsqrt_table[176] = 16'h04d3;
    rsqrt_table[177] = 16'h04cf;
    rsqrt_table[178] = 16'h04cc;
    rsqrt_table[179] = 16'h04c9;
    rsqrt_table[180] = 16'h04c5;
    rsqrt_table[181] = 16'h04c2;
    rsqrt_table[182] = 16'h04be;
    rsqrt_table[183] = 16'h04bb;
    rsqrt_table[184] = 16'h04b8;
    rsqrt_table[185] = 16'h04b5;
    rsqrt_table[186] = 16'h04b1;
    rsqrt_table[187] = 16'h04ae;
    rsqrt_table[188] = 16'h04ab;
    rsqrt_table[189] = 16'h04a8;
    rsqrt_table[190] = 16'h04a5;
    rsqrt_table[191] = 16'h04a2;
    rsqrt_table[192] = 16'h049e;
    rsqrt_table[193] = 16'h049b;
    rsqrt_table[194] = 16'h0498;
    rsqrt_table[195] = 16'h0495;
    rsqrt_table[196] = 16'h0492;
    rsqrt_table[197] = 16'h048f;
    rsqrt_table[198] = 16'h048c;
    rsqrt_table[199] = 16'h0489;
    rsqrt_table[200] = 16'h0487;
    rsqrt_table[201] = 16'h0484;
    rsqrt_table[202] = 16'h0481;
    rsqrt_table[203] = 16'h047e;
    rsqrt_table[204] = 16'h047b;
    rsqrt_table[205] = 16'h0478;
    rsqrt_table[206] = 16'h0476;
    rsqrt_table[207] = 16'h0473;
    rsqrt_table[208] = 16'h0470;
    rsqrt_table[209] = 16'h046d;
    rsqrt_table[210] = 16'h046b;
    rsqrt_table[211] = 16'h0468;
    rsqrt_table[212] = 16'h0465;
    rsqrt_table[213] = 16'h0463;
    rsqrt_table[214] = 16'h0460;
    rsqrt_table[215] = 16'h045d;
    rsqrt_table[216] = 16'h045b;
    rsqrt_table[217] = 16'h0458;
    rsqrt_table[218] = 16'h0456;
    rsqrt_table[219] = 16'h0453;
    rsqrt_table[220] = 16'h0451;
    rsqrt_table[221] = 16'h044e;
    rsqrt_table[222] = 16'h044c;
    rsqrt_table[223] = 16'h0449;
    rsqrt_table[224] = 16'h0447;
    rsqrt_table[225] = 16'h0444;
    rsqrt_table[226] = 16'h0442;
    rsqrt_table[227] = 16'h043f;
    rsqrt_table[228] = 16'h043d;
    rsqrt_table[229] = 16'h043b;
    rsqrt_table[230] = 16'h0438;
    rsqrt_table[231] = 16'h0436;
    rsqrt_table[232] = 16'h0434;
    rsqrt_table[233] = 16'h0431;
    rsqrt_table[234] = 16'h042f;
    rsqrt_table[235] = 16'h042d;
    rsqrt_table[236] = 16'h042b;
    rsqrt_table[237] = 16'h0428;
    rsqrt_table[238] = 16'h0426;
    rsqrt_table[239] = 16'h0424;
    rsqrt_table[240] = 16'h0422;
    rsqrt_table[241] = 16'h041f;
    rsqrt_table[242] = 16'h041d;
    rsqrt_table[243] = 16'h041b;
    rsqrt_table[244] = 16'h0419;
    rsqrt_table[245] = 16'h0417;
    rsqrt_table[246] = 16'h0415;
    rsqrt_table[247] = 16'h0412;
    rsqrt_table[248] = 16'h0410;
    rsqrt_table[249] = 16'h040e;
    rsqrt_table[250] = 16'h040c;
    rsqrt_table[251] = 16'h040a;
    rsqrt_table[252] = 16'h0408;
    rsqrt_table[253] = 16'h0406;
    rsqrt_table[254] = 16'h0404;
    rsqrt_table[255] = 16'h0402;
  end

  // GELU table (256 x 16-bit)
  logic [15:0] gelu_table [0:255];
  initial begin
    gelu_table[0] = 16'h0040;
    gelu_table[1] = 16'h0042;
    gelu_table[2] = 16'h0044;
    gelu_table[3] = 16'h0046;
    gelu_table[4] = 16'h0049;
    gelu_table[5] = 16'h004b;
    gelu_table[6] = 16'h004e;
    gelu_table[7] = 16'h0050;
    gelu_table[8] = 16'h0053;
    gelu_table[9] = 16'h0056;
    gelu_table[10] = 16'h0059;
    gelu_table[11] = 16'h005c;
    gelu_table[12] = 16'h005f;
    gelu_table[13] = 16'h0062;
    gelu_table[14] = 16'h0065;
    gelu_table[15] = 16'h0069;
    gelu_table[16] = 16'h006c;
    gelu_table[17] = 16'h0070;
    gelu_table[18] = 16'h0073;
    gelu_table[19] = 16'h0077;
    gelu_table[20] = 16'h007b;
    gelu_table[21] = 16'h007f;
    gelu_table[22] = 16'h0082;
    gelu_table[23] = 16'h0086;
    gelu_table[24] = 16'h008a;
    gelu_table[25] = 16'h008e;
    gelu_table[26] = 16'h0092;
    gelu_table[27] = 16'h0096;
    gelu_table[28] = 16'h009b;
    gelu_table[29] = 16'h009f;
    gelu_table[30] = 16'h00a3;
    gelu_table[31] = 16'h00a7;
    gelu_table[32] = 16'h00ac;
    gelu_table[33] = 16'h00b0;
    gelu_table[34] = 16'h00b4;
    gelu_table[35] = 16'h00b9;
    gelu_table[36] = 16'h00bd;
    gelu_table[37] = 16'h00c2;
    gelu_table[38] = 16'h00c6;
    gelu_table[39] = 16'h00cb;
    gelu_table[40] = 16'h00cf;
    gelu_table[41] = 16'h00d4;
    gelu_table[42] = 16'h00d8;
    gelu_table[43] = 16'h00dd;
    gelu_table[44] = 16'h00e1;
    gelu_table[45] = 16'h00e6;
    gelu_table[46] = 16'h00ea;
    gelu_table[47] = 16'h00ef;
    gelu_table[48] = 16'h00f3;
    gelu_table[49] = 16'h00f8;
    gelu_table[50] = 16'h00fc;
    gelu_table[51] = 16'h0101;
    gelu_table[52] = 16'h0105;
    gelu_table[53] = 16'h010a;
    gelu_table[54] = 16'h010e;
    gelu_table[55] = 16'h0113;
    gelu_table[56] = 16'h0117;
    gelu_table[57] = 16'h011b;
    gelu_table[58] = 16'h0120;
    gelu_table[59] = 16'h0124;
    gelu_table[60] = 16'h0129;
    gelu_table[61] = 16'h012d;
    gelu_table[62] = 16'h0131;
    gelu_table[63] = 16'h0136;
    gelu_table[64] = 16'h013a;
    gelu_table[65] = 16'h013f;
    gelu_table[66] = 16'h0143;
    gelu_table[67] = 16'h0147;
    gelu_table[68] = 16'h014b;
    gelu_table[69] = 16'h0150;
    gelu_table[70] = 16'h0154;
    gelu_table[71] = 16'h0158;
    gelu_table[72] = 16'h015d;
    gelu_table[73] = 16'h0161;
    gelu_table[74] = 16'h0165;
    gelu_table[75] = 16'h0169;
    gelu_table[76] = 16'h016d;
    gelu_table[77] = 16'h0172;
    gelu_table[78] = 16'h0176;
    gelu_table[79] = 16'h017a;
    gelu_table[80] = 16'h017e;
    gelu_table[81] = 16'h0182;
    gelu_table[82] = 16'h0186;
    gelu_table[83] = 16'h018a;
    gelu_table[84] = 16'h018f;
    gelu_table[85] = 16'h0193;
    gelu_table[86] = 16'h0197;
    gelu_table[87] = 16'h019b;
    gelu_table[88] = 16'h019f;
    gelu_table[89] = 16'h01a3;
    gelu_table[90] = 16'h01a7;
    gelu_table[91] = 16'h01ab;
    gelu_table[92] = 16'h01af;
    gelu_table[93] = 16'h01b3;
    gelu_table[94] = 16'h01b7;
    gelu_table[95] = 16'h01bb;
    gelu_table[96] = 16'h01c0;
    gelu_table[97] = 16'h01c4;
    gelu_table[98] = 16'h01c8;
    gelu_table[99] = 16'h01cc;
    gelu_table[100] = 16'h01d0;
    gelu_table[101] = 16'h01d4;
    gelu_table[102] = 16'h01d8;
    gelu_table[103] = 16'h01dc;
    gelu_table[104] = 16'h01e0;
    gelu_table[105] = 16'h01e4;
    gelu_table[106] = 16'h01e8;
    gelu_table[107] = 16'h01ec;
    gelu_table[108] = 16'h01f0;
    gelu_table[109] = 16'h01f4;
    gelu_table[110] = 16'h01f8;
    gelu_table[111] = 16'h01fc;
    gelu_table[112] = 16'h0200;
    gelu_table[113] = 16'h0204;
    gelu_table[114] = 16'h0208;
    gelu_table[115] = 16'h020c;
    gelu_table[116] = 16'h0210;
    gelu_table[117] = 16'h0214;
    gelu_table[118] = 16'h0218;
    gelu_table[119] = 16'h021c;
    gelu_table[120] = 16'h0220;
    gelu_table[121] = 16'h0224;
    gelu_table[122] = 16'h0228;
    gelu_table[123] = 16'h022c;
    gelu_table[124] = 16'h0230;
    gelu_table[125] = 16'h0234;
    gelu_table[126] = 16'h0238;
    gelu_table[127] = 16'h023c;
    gelu_table[128] = 16'h0040;
    gelu_table[129] = 16'h0040;
    gelu_table[130] = 16'h0040;
    gelu_table[131] = 16'h0040;
    gelu_table[132] = 16'h0040;
    gelu_table[133] = 16'h0040;
    gelu_table[134] = 16'h0040;
    gelu_table[135] = 16'h0040;
    gelu_table[136] = 16'h0040;
    gelu_table[137] = 16'h0040;
    gelu_table[138] = 16'h0040;
    gelu_table[139] = 16'h0040;
    gelu_table[140] = 16'h0040;
    gelu_table[141] = 16'h0040;
    gelu_table[142] = 16'h0040;
    gelu_table[143] = 16'h0040;
    gelu_table[144] = 16'h0040;
    gelu_table[145] = 16'h0040;
    gelu_table[146] = 16'h0040;
    gelu_table[147] = 16'h0040;
    gelu_table[148] = 16'h0040;
    gelu_table[149] = 16'h0040;
    gelu_table[150] = 16'h0040;
    gelu_table[151] = 16'h0040;
    gelu_table[152] = 16'h0040;
    gelu_table[153] = 16'h0040;
    gelu_table[154] = 16'h0040;
    gelu_table[155] = 16'h0040;
    gelu_table[156] = 16'h0040;
    gelu_table[157] = 16'h0040;
    gelu_table[158] = 16'h0040;
    gelu_table[159] = 16'h0040;
    gelu_table[160] = 16'h0040;
    gelu_table[161] = 16'h003f;
    gelu_table[162] = 16'h003f;
    gelu_table[163] = 16'h003f;
    gelu_table[164] = 16'h003f;
    gelu_table[165] = 16'h003f;
    gelu_table[166] = 16'h003f;
    gelu_table[167] = 16'h003f;
    gelu_table[168] = 16'h003f;
    gelu_table[169] = 16'h003f;
    gelu_table[170] = 16'h003f;
    gelu_table[171] = 16'h003f;
    gelu_table[172] = 16'h003f;
    gelu_table[173] = 16'h003e;
    gelu_table[174] = 16'h003e;
    gelu_table[175] = 16'h003e;
    gelu_table[176] = 16'h003e;
    gelu_table[177] = 16'h003e;
    gelu_table[178] = 16'h003e;
    gelu_table[179] = 16'h003e;
    gelu_table[180] = 16'h003d;
    gelu_table[181] = 16'h003d;
    gelu_table[182] = 16'h003d;
    gelu_table[183] = 16'h003d;
    gelu_table[184] = 16'h003d;
    gelu_table[185] = 16'h003c;
    gelu_table[186] = 16'h003c;
    gelu_table[187] = 16'h003c;
    gelu_table[188] = 16'h003b;
    gelu_table[189] = 16'h003b;
    gelu_table[190] = 16'h003b;
    gelu_table[191] = 16'h003b;
    gelu_table[192] = 16'h003a;
    gelu_table[193] = 16'h003a;
    gelu_table[194] = 16'h0039;
    gelu_table[195] = 16'h0039;
    gelu_table[196] = 16'h0039;
    gelu_table[197] = 16'h0038;
    gelu_table[198] = 16'h0038;
    gelu_table[199] = 16'h0037;
    gelu_table[200] = 16'h0037;
    gelu_table[201] = 16'h0037;
    gelu_table[202] = 16'h0036;
    gelu_table[203] = 16'h0036;
    gelu_table[204] = 16'h0035;
    gelu_table[205] = 16'h0035;
    gelu_table[206] = 16'h0034;
    gelu_table[207] = 16'h0034;
    gelu_table[208] = 16'h0033;
    gelu_table[209] = 16'h0033;
    gelu_table[210] = 16'h0032;
    gelu_table[211] = 16'h0032;
    gelu_table[212] = 16'h0031;
    gelu_table[213] = 16'h0031;
    gelu_table[214] = 16'h0030;
    gelu_table[215] = 16'h0030;
    gelu_table[216] = 16'h002f;
    gelu_table[217] = 16'h002f;
    gelu_table[218] = 16'h002e;
    gelu_table[219] = 16'h002e;
    gelu_table[220] = 16'h002d;
    gelu_table[221] = 16'h002d;
    gelu_table[222] = 16'h002c;
    gelu_table[223] = 16'h002c;
    gelu_table[224] = 16'h002c;
    gelu_table[225] = 16'h002b;
    gelu_table[226] = 16'h002b;
    gelu_table[227] = 16'h002b;
    gelu_table[228] = 16'h002b;
    gelu_table[229] = 16'h002a;
    gelu_table[230] = 16'h002a;
    gelu_table[231] = 16'h002a;
    gelu_table[232] = 16'h002a;
    gelu_table[233] = 16'h002a;
    gelu_table[234] = 16'h002a;
    gelu_table[235] = 16'h002b;
    gelu_table[236] = 16'h002b;
    gelu_table[237] = 16'h002b;
    gelu_table[238] = 16'h002b;
    gelu_table[239] = 16'h002c;
    gelu_table[240] = 16'h002c;
    gelu_table[241] = 16'h002d;
    gelu_table[242] = 16'h002d;
    gelu_table[243] = 16'h002e;
    gelu_table[244] = 16'h002f;
    gelu_table[245] = 16'h0030;
    gelu_table[246] = 16'h0031;
    gelu_table[247] = 16'h0032;
    gelu_table[248] = 16'h0033;
    gelu_table[249] = 16'h0034;
    gelu_table[250] = 16'h0036;
    gelu_table[251] = 16'h0037;
    gelu_table[252] = 16'h0039;
    gelu_table[253] = 16'h003a;
    gelu_table[254] = 16'h003c;
    gelu_table[255] = 16'h003e;
  end

  // Output mux
  always_comb begin
    case (func_sel_i)
      FUNC_EXP:   result_o = exp_table[index_i];
      FUNC_RECIP: result_o = recip_table[index_i];
      FUNC_RSQRT: result_o = rsqrt_table[index_i];
      FUNC_GELU:  result_o = gelu_table[index_i];
      default:    result_o = 16'h0000;
    endcase
  end

endmodule